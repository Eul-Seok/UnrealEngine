# 월드 파티션 (World Partition)

월드 파티션은 언리얼 엔진 5에 도입된 새로운 대규모 월드 관리 시스템입니다. 거대한 월드를 자동으로 그리드 단위로 나누고 플레이어의 위치에 따라 필요한 부분만 스트리밍하여 로드합니다.

이를 통해 개발자는 더 이상 레벨을 수동으로 분할하고 스트리밍을 관리할 필요 없이, 하나의 거대한 퍼시스턴트 레벨에서 원활하게 작업할 수 있습니다.

## 기존 월드 컴포지션과의 차이점

-   **UE4 (월드 컴포지션)**: 개발자가 직접 서브 레벨을 나누고, 로드/언로드를 수동으로 관리해야 했습니다. 협업 시 레벨 파일에 대한 소유권 문제로 충돌이 잦았습니다.
-   **UE5 (월드 파티션)**: 자동화된 그리드 기반 스트리밍과 '액터당 하나의 파일(OFPA)' 시스템 덕분에 협업 효율성과 성능 관리가 크게 향상되었습니다.

## 주요 이점

-   **성능 및 메모리 관리**: 플레이어 주변의 월드만 로드하므로, 초대형 월드를 제작하더라도 메모리 사용량을 효율적으로 관리하고 높은 성능을 유지할 수 있습니다.
-   **워크플로 간소화**: 모든 팀원이 하나의 레벨 파일에서 동시에 작업할 수 있어 월드 제작 과정이 단순화됩니다.
-   **향상된 팀 협업**: '액터당 하나의 파일(OFPA)' 시스템을 통해 여러 개발자가 동일한 월드의 다른 액터를 동시에 수정해도 소스 컨트롤에서 파일 충돌이 발생하지 않습니다.

## 핵심 기능

### 1. 그리드 기반 스트리밍

월드 파티션은 전체 월드를 2D 그리드로 나눕니다. 각 그리드 셀은 스트리밍의 단위가 되며, 플레이어와의 거리에 따라 동적으로 로드되거나 언로드됩니다. 셀의 크기와 로딩 범위는 프로젝트 설정에서 자유롭게 조절할 수 있습니다.

### 2. 데이터 레이어 (Data Layers)

액터를 특정 데이터 레이어에 할당하여 콘텐츠를 체계적으로 구성하고, 특정 조건에 따라 해당 레이어를 동적으로 로드하거나 언로드할 수 있습니다.

> **활용 예시:**
> -   **게임플레이 변주**: 낮/밤 전환, 계절 변화, 특정 퀘스트 진행 상태에 따라 다른 오브젝트 세트를 로드할 수 있습니다.
> -   **레벨 디자인**: 같은 맵에서 테스트용 콘텐츠와 실제 출시용 콘텐츠를 분리하여 관리할 수 있습니다.

### 3. HLOD (Hierarchical Level of Detail)

월드 파티션은 HLOD를 자동으로 생성하는 기능을 제공합니다. 멀리 있는 수천 개의 나무, 건물, 바위 등을 하나의 단순화된 메시로 묶어 렌더링함으로써 드로우 콜(Draw Call) 수를 크게 줄여 성능을 최적화합니다.

### 4. 액터당 하나의 파일 (One File Per Actor - OFPA)

월드에 배치된 모든 액터가 개별 파일로 저장되는 시스템입니다. 예를 들어, 월드에 나무 한 그루를 추가하면 해당 나무에 대한 `.uasset` 파일 하나만 변경됩니다. 따라서 전체 레벨 파일을 저장할 필요가 없어 소스 컨트롤에 커밋하는 시간이 단축되고 팀원 간의 충돌이 최소화됩니다.

## 고려 사항

-   **네비게이션 메시 (NavMesh)**: 네비게이션 메시는 스트리밍되는 셀 단위로 나뉘어 관리되므로, AI가 로드되지 않은 지역을 포함한 월드 전체 경로를 탐색해야 하는 경우 추가적인 설계가 필요합니다.
-   **레벨 변환**: 월드 컴포지션을 사용하던 기존 프로젝트를 월드 파티션으로 전환하려면 `WorldPartitionConvertCommandlet`을 사용하여 레벨을 변환하는 과정이 필요합니다.